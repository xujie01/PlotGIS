define(["dojo/_base/declare", "dojo/_base/lang","./PlotUtil"],    function (declare, lang, PlotUtil) {    var clazz = declare([], {        //自定义燕尾箭头        constructor: function (options) {            if (this.id == null) {                this.id = "CustomTailedArrowDrawer"            }        },        headHeightFactor: 0.15,        headWidthFactor: 0.4,        neckHeightFactor: 0.75,        neckWidthFactor: 0.15,        tailWidthFactor: 0.1,        swallowTailFactor: 1,        headRightPnt: null,        neckPnt: null,        swallowTailPnt: null,        plotState: "drawing",        getPoints: function (points) {            var point0 = null;            var point1 = null;            var midPoint = null;            var midPoints = null;            var headPoints = null;            var headPoint0 = null;            var headPoint4 = null;            var bLen = null;            var disPnts = null;            var N1 = null;            var bodyPoints = null;            var bodyPoints1 = null;            var bodyPoints2 = null;            var tailPnts = null;            var pntsLen = points.length;            if (pntsLen >= 3 && points[(pntsLen - 1)] != points[pntsLen - 2]) {                point0 = points[0];                point1 = points[1];                midPoint = PlotUtil.getMidPoint(point0, point1);                midPoints = [midPoint];                midPoints = midPoints.concat(points.slice(2));                headPoints = PlotUtil.getArrowHeadPoints(midPoints, this.headHeightFactor, this.headWidthFactor, this.neckHeightFactor, this.neckWidthFactor);                headPoint0 = headPoints[0];                headPoint4 = headPoints[4];                bLen = PlotUtil.getBaseLength(midPoints);                disPnts = PlotUtil.distance(point0, point1);                N1 = disPnts / 2 / bLen;                bodyPoints = PlotUtil.getArrowBodyPoints(midPoints, headPoint0, headPoint4, N1);                if (this.plotState == "drawing") {                    this.swallowTailPnt = PlotUtil.getThirdPoint(midPoints[1], midPoints[0], 0, bLen * this.tailWidthFactor * this.swallowTailFactor, PlotUtil.LEFTSIDE)                }                pntsLen = bodyPoints.length;                bodyPoints1 = bodyPoints.slice(0, pntsLen / 2);                bodyPoints2 = bodyPoints.slice(pntsLen / 2, pntsLen);                bodyPoints1.push(headPoint0);                bodyPoints2.push(headPoint4);                bodyPoints1 = bodyPoints1.reverse();                bodyPoints1.push(point0);                bodyPoints2 = bodyPoints2.reverse();                bodyPoints2.push(point1);                bodyPoints1 = PlotUtil.getBSplinePoints(bodyPoints1);                bodyPoints2 = PlotUtil.getBSplinePoints(bodyPoints2);                tailPnts = bodyPoints1.reverse().concat(headPoints, bodyPoints2);                tailPnts.push(this.swallowTailPnt);                return tailPnts            }            return null        }    });    return clazz});